<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>What is British or German styling and can a machine tell the difference?</title>

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="css/clean-blog.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="index.html">166 Inter</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="https://twitter.com/166inter">Contact</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('img/post-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>What is British or German styling and can a machine &emsp; &emsp; &emsp; tell the difference?</h1>
                        <h2 class="subheading">Re-training Tensorflow's Inception to classify car origin</h2>
                        <span class="meta">Posted by <a href="#">Nicholas Schmidt</a> on July 22, 2017</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <h3> Intro </h4>

                    <p> &emsp; I was walking home the other day this week, looking at the various cars on the street German, Japanese, American and so on and it got me thinking. What is it that I find more visually appealing about German and Japanese cars? Why do I react differently to cars from certain countries? Is there something fundamental about British styling, Italian styling, and so on? Google not too long ago open-sourced a pre-trained, 40+ layer deep neural network called Inception. Alongside, there is a tutorial, <a href="https://codelabs.developers.google.com/codelabs/tensorflow-for-poets/#0" target="_blank"> Tensorflow for Poets</a>, which shows how to use this network and train the last layer so you can have it classify between your very own image datasets! </p>

                    <h3> Methods</h4>

                   <p> &emsp; I followed the tutorial and then tried it again with a data set of about 500 images, about a fifth from each of five car origins: Germany, Japan, United States, Italy and Great Britain. There are some Google Chrome extensions you can use to bulk download Google Images results. I had to clean up what I downloaded and delete some photos that were out of place. The photos are about 10-20 kb in size, which makes them faster to train with. </p>

                    <h3> Results</h4>
<p> &emsp; While training with flower data set given in the tutorial yieled around 90% test accuracy, the network achieved just 73.1% on my much smaller dataset of car photos. Keep in mind, if one were to make random guesses, they would most likely average 20% accuracy. Below are some additional test results for some novel downloaded images, 2 from each car origin. The network does  make some funny predictions, but other predictions are very good: </p>
                    
                    <pre>
  <code>
2017-07-22 04:57:55.607929: Step 490: Train accuracy = 76.0%
2017-07-22 04:57:55.608473: Step 490: Cross entropy = 0.764508
2017-07-22 04:57:55.916217: Step 490: Validation accuracy = 58.0% (N=100)
2017-07-22 04:57:58.682838: Step 499: Train accuracy = 74.0%
2017-07-22 04:57:58.683158: Step 499: Cross entropy = 0.778337
2017-07-22 04:57:58.989198: Step 499: Validation accuracy = 60.0% (N=100)
Final test accuracy = 73.1% (N=52)
  </code>
</pre>
<table width="100%" cellspacing="500">
    <tr>
        <td><img  src="img/german_test.jpg" alt="https://raw.githubusercontent.com/166inter/166inter.github.io/master/test_photos/german_test.jpg" alt="Image not found" style="width:180px" border = "1px" />
        

        </td>
        <td width="500%" align="center"><pre>
                            <code>
label_image.py german_test.jpg
italian (score = 0.25074)
german (score = 0.22876)
japanese (score = 0.21431)
american (score = 0.15670)
british (score = 0.14949)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/japanese_test.jpg" alt="Image not found" style="width:110%" border = "1px" />
        </td>
        <td width="500%" align="center"> <pre>
                            <code>
label_image.py japanese_test.jpg
american (score = 0.27312)
german (score = 0.25250)
british (score = 0.21902)
italian (score = 0.18549)
japanese (score = 0.06987)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/british_test.jpg" alt="Image not found" style="width:110%" border = "1px" />


        </td>
        <td width="50%" align="center"><pre>
                            <code>
python label_image.py british_test.jpg
british (score = 0.53528)
american (score = 0.20071)
german (score = 0.15943)
italian (score = 0.08448)
japanese (score = 0.02009)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/italian_test.jpg" alt="Image not found" style="width:110%" border = "1px" />


        </td>
        <td width="50%" align="center"><pre>
                            <code>
python label_image.py italian_test.jpg
italian (score = 0.58346)
german (score = 0.19087)
american (score = 0.08351)
japanese (score = 0.07983)
british (score = 0.06233)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/american_test.jpg" alt="Image not found" style="width:110%" border = "1px" />


        </td>
        <td width="50%" align="center"><pre>
                            <code>
python label_image.py american_test.jpg
german (score = 0.47028)
british (score = 0.25817)
american (score = 0.23781)
italian (score = 0.02941)
japanese (score = 0.00434)
</code>
</pre>
        </td>
    </tr>
    <tr>
        <td><img  src="img/german_test_2.jpg" alt="Image not found" style="width:180px" border = "1px" />
        

        </td>
        <td width="500%" align="center"><pre>
                            <code>
label_image.py german_test_2.jpg
german (score = 0.45688)
british (score = 0.23318)
italian (score = 0.15506)
american (score = 0.12687)
japanese (score = 0.02800)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/japanese_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />
        </td>
        <td width="500%" align="center"> <pre>
                            <code>
label_image.py japanese_test_2.jpg
japanese (score = 0.91580)
german (score = 0.03405)
american (score = 0.01899)
italian (score = 0.01780)
british (score = 0.01336)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/british_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />


        </td>
        <td width="50%" align="center"><pre>
                            <code>
python label_image.py british_test_2.jpg
german (score = 0.46645)
british (score = 0.23532)
italian (score = 0.12662)
american (score = 0.08663)
japanese (score = 0.08498)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/italian_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />


        </td>
        <td width="50%" align="center"><pre>
                            <code>
python label_image.py italian_test_2.jpg
italian (score = 0.58812)
british (score = 0.13577)
japanese (score = 0.12287)
german (score = 0.12016)
american (score = 0.03308)
</code>
</pre>
        </td>
    </tr>

<tr>
        <td><img  src="img/american_test_2.jpg" alt="Image not found" style="width:110%" border = "1px" />


        </td>
        <td width="50%" align="center"><pre>
                            <code>
python label_image.py american_test_2.jpg
german (score = 0.48871)
british (score = 0.36794)
american (score = 0.08926)
italian (score = 0.02975)
japanese (score = 0.02435)
</code>
</pre>
        </td>
    </tr>

</table>

<h3> Discussion</h4>
<p> &emsp; This neural network is not going to outsmart a car fanatic quite yet. However, for a network trained on around 500 images, and all hyperparameters left untouched, it is quite impressive that it can guess better than 3x what random guessing would result in. Having cars from a very large time span added to the network's difficulty in making predictions. Design languages are not mutually exclusive from origin to origin so it can be difficult even for a car fanatic to make some distinctions. For example, the Kia Motors aquired a German designer to design the Kia Optima a few years back and it naturally had some German design cues.   </p>

<h3> Conclusion</h4>
<p> &emsp; There is certainly a correlation between the country of origin of various car and their respective design cues. The network could not simply read the badges for the various cars, so it had to recognize actual design features. The network did not do a very good job, but there is plenty of room for improvement. </p>
<h3> Future work</h4>
<p> &emsp; Since neural networks always work better with more data, adding more training examples would certainly yield better results. The hyperparameters could be tweaked. We could see how a simpler convolutional neural network with fewer layers would fare (this would require going beyond simply retraining Inception and creating our own network). The dataset could also be refined and cleaned to include only cars from a specified era to see if this would give better results.</p>
<hr/>


                    <!--<p>For those who have seen the Earth from space, and for the hundreds and perhaps thousands more who will, the experience most certainly changes your perspective. The things that we share in our world are far more valuable than those which divide us.</p>

                    <h2 class="section-heading">The Final Frontier</h2>

                    <p>There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.</p>

                    <p>There can be no thought of finishing for ‘aiming for the stars.’ Both figuratively and literally, it is a task to occupy the generations. And no matter how much progress one makes, there is always the thrill of just beginning.</p>

                    <blockquote>The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.</blockquote>

                    <p>Spaceflights cannot be stopped. This is not the work of any one man or even a group of men. It is a historical process which mankind is carrying out in accordance with the natural laws of human development.</p>

                    <h2 class="section-heading">Reaching for the Stars</h2>

                    <p>As we got further and further away, it [the Earth] diminished in size. Finally it shrank to the size of a marble, the most beautiful you can imagine. That beautiful, warm, living object looked so fragile, so delicate, that if you touched it with a finger it would crumble and fall apart. Seeing this has to change a man.</p>

                    <a href="#">
                        <img class="img-responsive" src="img/post-sample-image.jpg" alt="">
                    </a>
                    <span class="caption text-muted">To go places and do things that have never been done before – that’s what living is all about.</span>

                    <p>Space, the final frontier. These are the voyages of the Starship Enterprise. Its five-year mission: to explore strange new worlds, to seek out new life and new civilizations, to boldly go where no man has gone before.</p>

                    <p>As I stand out here in the wonders of the unknown at Hadley, I sort of realize there’s a fundamental truth to our nature, Man must explore, and this is exploration at its greatest.</p>

                    <p>Placeholder text by <a href="http://spaceipsum.com/">Space Ipsum</a>. Photographs by <a href="https://www.flickr.com/photos/nasacommons/">NASA on The Commons</a>.</p>-->
                </div>
            </div>
        </div>
    </article>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/166inter">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; Your Website 2016</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="js/clean-blog.min.js"></script>

</body>

</html>
